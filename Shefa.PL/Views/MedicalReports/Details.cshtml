@model SmartHealthcare.Models.MedicalReport

@{
    ViewBag.Title = "Medical Report Details";
}

<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h4 class="mb-0">
                        <i class="fas fa-file-medical-alt"></i> Medical Report #@Model.MedicalReportID
                    </h4>
                </div>

                <div class="card-body">
                    <!-- Hospital Header -->
                    <div class="text-center mb-4">
                        <h3 class="text-info">Smart Healthcare System</h3>
                        <p class="mb-0">Medical Report</p>
                    </div>

                    <hr />

                    <!-- Report Date & ID -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <p class="mb-1"><strong>Report ID:</strong> #@Model.MedicalReportID</p>
                            <p class="mb-1"><strong>Report Date:</strong> @Model.ReportDate?.ToString("dddd, MMMM dd, yyyy")</p>
                            <p class="mb-1"><strong>Time:</strong> @Model.ReportDate?.ToString("hh:mm tt")</p>
                        </div>
                        <div class="col-md-6 text-md-end">
                            <p class="mb-1"><strong>Appointment ID:</strong> #@Model.AppointmentID</p>
                        </div>
                    </div>

                    <hr />

                    <!-- Patient & Doctor Information -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6 class="text-info"><i class="fas fa-user"></i> Patient Information</h6>
                            <p class="mb-1"><strong>Name:</strong> @Model.Appointment?.Patient?.FullName</p>

                            @if (Model.Appointment?.Patient?.DateOfBirth != null)
                            {
                                <p class="mb-1">
                                    <strong>Age:</strong>
                                    @(DateTime.Now.Year - Model.Appointment.Patient.DateOfBirth.Value.Year) years
                                </p>
                            }

                            <p class="mb-1"><strong>Gender:</strong> @Model.Appointment?.Patient?.Gender</p>
                            <p class="mb-1">
                                <strong>Blood Group:</strong>
                                <span class="badge bg-danger">@Model.Appointment?.Patient?.BloodGroup</span>
                            </p>
                        </div>

                        <div class="col-md-6">
                            <h6 class="text-info"><i class="fas fa-user-md"></i> Doctor Information</h6>
                            <p class="mb-1"><strong>Name:</strong> @Model.DoctorName</p>
                            <p class="mb-1"><strong>Specialization:</strong> @Model.Doctor?.Specialization</p>
                            <p class="mb-1"><strong>Qualification:</strong> @Model.Doctor?.Qualification</p>
                        </div>
                    </div>

                    <hr />

                    <!-- Diagnosis -->
                    <div class="mb-4">
                        <h5 class="text-info mb-3"><i class="fas fa-stethoscope"></i> Diagnosis</h5>
                        <div class="alert alert-danger">
                            <p class="mb-0">@Model.Diagnosis</p>
                        </div>
                    </div>

                    <!-- Treatment Plan -->
                    <div class="mb-4">
                        <h5 class="text-info mb-3"><i class="fas fa-pills"></i> Treatment Plan</h5>
                        <div class="card bg-light">
                            <div class="card-body">
                                <p class="mb-0">@Html.Raw(Model.Treatment?.Replace("\n", "<br/>"))</p>
                            </div>
                        </div>
                    </div>

                    @if (!string.IsNullOrEmpty(Model.LabResults))
                    {
                        <div class="mb-4">
                            <h5 class="text-info mb-3"><i class="fas fa-flask"></i> Laboratory Results</h5>
                            <div class="card bg-light">
                                <div class="card-body">
                                    <p class="mb-0">@Html.Raw(Model.LabResults.Replace("\n", "<br/>"))</p>
                                </div>
                            </div>
                        </div>
                    }

                    @if (!string.IsNullOrEmpty(Model.Remarks))
                    {
                        <div class="mb-4">
                            <h5 class="text-info mb-3"><i class="fas fa-comment-medical"></i> Doctor's Remarks</h5>
                            <div class="card bg-light">
                                <div class="card-body">
                                    <p class="mb-0">@Model.Remarks</p>
                                </div>
                            </div>
                        </div>
                    }

                    @if (Model.FollowUpDate != null)
                    {
                        <div class="mb-4">
                            <h5 class="text-info mb-3"><i class="fas fa-calendar-check"></i> Follow-up Instructions</h5>
                            <div class="alert alert-warning">
                                <p class="mb-0"><strong>Follow-up:</strong> @Model.FollowUpDate?.ToString("dd/MM/yyyy")</p>
                            </div>
                        </div>
                    }

                    <hr />

                    <!-- Doctor's Signature -->
                    <div class="mt-5 text-end">
                        <p class="mb-0"><strong>Doctor's Signature</strong></p>
                        <p class="text-muted mb-0">@Model.DoctorName</p>
                        <p class="text-muted">@Model.Doctor?.Qualification</p>
                    </div>
                </div>

                <div class="card-footer bg-light">
                    <div class="d-flex justify-content-between">
                        <a href="@Url.Action("Index", "MedicalReports")" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Back to List
                        </a>
                        <div>
                            <button onclick="window.print()" class="btn btn-info">
                                <i class="fas fa-print"></i> Print Report
                            </button>
                            @if (User.IsInRole("Admin") || User.IsInRole("Doctor"))
                            {
                                <a href="@Url.Action("Edit", "MedicalReports", new { id = Model.MedicalReportID })"
                                   class="btn btn-warning">
                                    <i class="fas fa-edit"></i> Edit
                                </a>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border: none;
        border-radius: 10px;
    }

    media print {
        .btn, .card-footer {
            display: none !important;
        }
        .card {
            box-shadow: none !important;
        }
    }
</style>
