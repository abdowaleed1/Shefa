@{
    ViewBag.Title = "Patient Reviews";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container py-5">
    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="fw-bold text-dark mb-0">⭐ Patient Reviews & Feedback</h1>
            <p class="text-muted">See what patients say about our doctors and services</p>
        </div>
        <button type="button" class="btn btn-primary btn-lg shadow-sm" data-bs-toggle="modal" data-bs-target="#submitReviewModal">
            <i class="bi bi-pencil-square me-1"></i> Submit Review
        </button>
    </div>

    <!-- Summary Card -->
    <div class="card shadow-sm border-0 mb-5">
        <div class="card-body">
            <div class="row align-items-center">
                <div class="col-md-4 text-center border-end">
                    <h6 class="text-muted">Overall Rating</h6>
                    <h1 class="display-3 fw-bold text-success">4.8</h1>
                    <div class="text-warning fs-4 mb-1">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-half"></i>
                    </div>
                    <small class="text-muted">Based on 1,245 verified reviews</small>
                </div>

                <div class="col-md-8">
                    <h5 class="fw-bold text-dark mb-3">Patient Satisfaction Breakdown</h5>
                    <div class="progress mb-2" style="height: 10px;">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 85%"></div>
                    </div>
                    <div class="d-flex justify-content-between text-muted mb-3">
                        <span>Excellent</span><span>85%</span>
                    </div>
                    <div class="progress mb-2" style="height: 10px;">
                        <div class="progress-bar bg-info" role="progressbar" style="width: 10%"></div>
                    </div>
                    <div class="d-flex justify-content-between text-muted mb-3">
                        <span>Good</span><span>10%</span>
                    </div>
                    <div class="progress mb-2" style="height: 10px;">
                        <div class="progress-bar bg-warning" role="progressbar" style="width: 4%"></div>
                    </div>
                    <div class="d-flex justify-content-between text-muted mb-3">
                        <span>Average</span><span>4%</span>
                    </div>
                    <div class="progress mb-2" style="height: 10px;">
                        <div class="progress-bar bg-danger" role="progressbar" style="width: 1%"></div>
                    </div>
                    <div class="d-flex justify-content-between text-muted">
                        <span>Poor</span><span>1%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Bar -->
    <div class="input-group mb-4 shadow-sm">
        <input type="text" class="form-control form-control-lg" placeholder="🔍 Search reviews (e.g. Dr. Sharma, Cardiology, Service)" />
        <button class="btn btn-outline-primary">Search</button>
    </div>

    <!-- Review Cards -->
    <h3 class="mb-4 fw-bold text-primary">Recent Reviews</h3>

    <!-- Review 1 -->
    <div class="card mb-4 shadow-sm border-0 rounded-4">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <h5 class="fw-bold mb-1">Fantastic Experience with Dr. Sharma!</h5>
                    <p class="text-muted small mb-2">Reviewed by <strong>Priya Patel</strong> • October 30, 2025</p>
                    <div class="text-warning">
                        <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                    </div>
                </div>
                <span class="badge bg-success-subtle text-success border border-success fs-6 px-3 py-2">5/5</span>
            </div>
            <p class="mt-3 text-muted lh-lg">
                “Dr. Sharma was kind, attentive, and explained every step clearly. The hospital was clean and well-organized. Highly recommend this clinic to anyone seeking quality healthcare.”
            </p>
        </div>
    </div>

    <!-- Review 2 -->
    <div class="card mb-4 shadow-sm border-0 rounded-4">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <h5 class="fw-bold mb-1">Great Staff & Facilities</h5>
                    <p class="text-muted small mb-2">Reviewed by <strong>Rohan Mehta</strong> • October 22, 2025</p>
                    <div class="text-warning">
                        <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star"></i>
                    </div>
                </div>
                <span class="badge bg-warning-subtle text-warning border border-warning fs-6 px-3 py-2">4/5</span>
            </div>
            <p class="mt-3 text-muted lh-lg">
                “Staff members are polite and helpful. I faced a short waiting time, but the treatment quality made up for it. The reception and billing were smooth.”
            </p>
        </div>
    </div>

    <!-- Review 3 -->
    <div class="card mb-4 shadow-sm border-0 rounded-4">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <h5 class="fw-bold mb-1">Quick Appointment and Great Doctor</h5>
                    <p class="text-muted small mb-2">Reviewed by <strong>Anonymous</strong> • October 15, 2025</p>
                    <div class="text-warning">
                        <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i><i class="bi bi-star-half"></i><i class="bi bi-star"></i>
                    </div>
                </div>
                <span class="badge bg-info-subtle text-info border border-info fs-6 px-3 py-2">3.5/5</span>
            </div>
            <p class="mt-3 text-muted lh-lg">
                “Got an appointment easily and doctor’s advice was great. Waiting area could be improved, but overall service was decent.”
            </p>
        </div>
    </div>

    <!-- Pagination -->
    <nav>
        <ul class="pagination justify-content-center mt-5">
            <li class="page-item disabled"><a class="page-link">Previous</a></li>
            <li class="page-item active"><a class="page-link">1</a></li>
            <li class="page-item"><a class="page-link">2</a></li>
            <li class="page-item"><a class="page-link">3</a></li>
            <li class="page-item"><a class="page-link">Next</a></li>
        </ul>
    </nav>
</div>

<!-- Review Submission Modal -->
<div class="modal fade" id="submitReviewModal" tabindex="-1" aria-labelledby="submitReviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title fw-bold" id="submitReviewModalLabel">🩺 Share Your Experience</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form id="reviewForm">
                    <div class="mb-3">
                        <label class="fw-bold mb-2">Rating</label>
                        <div id="reviewRating" class="h4 text-warning">
                            <i class="bi bi-star clickable-star" data-rating="1"></i>
                            <i class="bi bi-star clickable-star" data-rating="2"></i>
                            <i class="bi bi-star clickable-star" data-rating="3"></i>
                            <i class="bi bi-star clickable-star" data-rating="4"></i>
                            <i class="bi bi-star clickable-star" data-rating="5"></i>
                            <input type="hidden" id="ratingValue" name="Rating" value="0" />
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="reviewTitle" class="fw-bold">Review Title</label>
                        <input type="text" class="form-control" id="reviewTitle" placeholder="e.g. Excellent Care by Dr. Mehta" required />
                    </div>

                    <div class="mb-3">
                        <label for="reviewText" class="fw-bold">Your Review</label>
                        <textarea class="form-control" id="reviewText" rows="4" placeholder="Share details of your visit..." required></textarea>
                    </div>

                    <div class="form-check mb-3">
                        <input type="checkbox" class="form-check-input" id="anonymousCheck" />
                        <label class="form-check-label" for="anonymousCheck">Post Anonymously</label>
                    </div>

                    <button type="submit" class="btn btn-success w-100">Submit Review</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Star Rating Interaction Script -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const stars = document.querySelectorAll('.clickable-star');
        const ratingInput = document.getElementById('ratingValue');

        stars.forEach(star => {
            star.style.cursor = 'pointer';
            star.addEventListener('click', function () {
                const rating = parseInt(this.dataset.rating);
                ratingInput.value = rating;
                updateStars(rating);
            });
        });

        function updateStars(rating) {
            stars.forEach(star => {
                const val = parseInt(star.dataset.rating);
                if (val <= rating) {
                    star.classList.remove('bi-star');
                    star.classList.add('bi-star-fill');
                } else {
                    star.classList.remove('bi-star-fill');
                    star.classList.add('bi-star');
                }
            });
        }
    });
</script>
